<?xml version="1.0" encoding="UTF-8"?>
<Consultas>
    <Consulta id="get_usuario">
        <sql>
        SELECT usuario_id, usuario_rol from usuario where usuario_usuario=$usuario_usuario and usuario_pwd=md5($usuario_pwd)
        </sql>
    </Consulta>
    <Consulta id="validate_user">
        <sql>
        SELECT usuario_id from usuario where usuario_usuario=token and usuario_pwd=md5($usuario_pwd)
        </sql>
    </Consulta>
    <Consulta id="update_clave">
        <sql>
        update usuario set usuario_pwd=md5($usuario_pwd_new) where usuario_usuario=token returning usuario_id
        </sql>
    </Consulta>
    <Consulta id="info1_general_proyecto">
        <sql>
        select * from info1_vw_dup where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info1_fuente">
        <sql>
        select * from info1_fuente where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info1_general_proyecto_servidumbre">
        <sql>
        select * from servidumbres.info1_general_proyecto_servidumbre where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="info2_general_predio">
        <sql>
        select * from info2_general_predio where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info2_adquisicion">
        <sql>
        select * from info2_adquisicion_vw where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info2_general_predio_sirviente">
        <sql>
        select * from servidumbres.info2_general_predio_sirviente where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="info3_areas_usos">
        <sql>
        select * from info3_areas_usos_vw where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info3_predios_segregados">
        <sql>
        select * from info3_predios_segregados_vw where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info3_general_predios_derivados">
        <sql>
        select * from servidumbres.info3_general_predios_derivados where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info4_avaluos">
        <sql>
        select * from info4_avaluos where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info4_informacion_catastral">
        <sql>
        select * from info4_informacion_catastral where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info4_areas_y_usos_predio_sirviente">
        <sql>
        select * from servidumbres.info4_areas_y_usos_predio_sirviente where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="info5_juridicos">
        <sql>
        select * from info5_juridicos where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info5_informacion_invias">
        <sql>
        select * from info5_informacion_invias where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info5_servidumbre">
        <sql>
        select * from servidumbres.info5_servidumbre where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="info6_propietario_anterior_juridico">
        <sql>
        select * from info6_propietario_anterior_juridico where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info6_avaluos">
        <sql>
        select * from info6_avaluos where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info6_avaluos_servidumbre">
        <sql>
        select * from servidumbres.info6_avaluos_servidumbre where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info7_propietario_catastral">
        <sql>
        select * from info7_propietario_catastral where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info7_control_calidad_juridico">
        <sql>
        select * from info7_control_calidad_juridico where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info7_orden_de_pago">
        <sql>
        select * from servidumbres.info7_orden_de_pago where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info8_propietario_juridico">
        <sql>
        select * from info8_propietario_juridico where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info8_control_calidad_catastral">
        <sql>
        select * from info8_control_calidad_catastral where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info8_soportes_pago">
        <sql>
        select * from servidumbres.info8_soportes_pago where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info9_zmpa">
        <sql>
        select * from info9_zmpa where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info9_juridico_servidumbre">
        <sql>
        select * from servidumbres.info9_juridico_servidumbre where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="info10_sig">
        <sql>
        select * from info10_sig where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info10_infraestructura">
        <sql>
        select * from info10_infraestructura where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info10_cons_servidumbre">
        <sql>
        select * from servidumbres.info10_cons_servidumbre where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info11_estudios_detallados">
        <sql>
        select * from info11_estudios_detallados where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info11_adquisicion_escritura">
        <sql>
        select * from info11_adquisicion_escritura where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info11_propietario_catastral">
        <sql>
        select * from servidumbres.info11_propietario_catastral where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info12_control_calidad_tecnico">
        <sql>
        select * from info12_control_calidad_tecnico where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info12_pago">
        <sql>
        select * from info12_pago where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info12_propietario_juridico_actual">
        <sql>
        select * from servidumbres.info12_propietario_juridico_actual where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info13_control_calidad_juridico">
        <sql>
        select * from info13_control_calidad_juridico where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info13_saneamiento_catastral">
        <sql>
        select * from info13_saneamiento_catastral_vw where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info13_propietario_constitucion_servidumbre_juridico">
        <sql>
        select * from servidumbres.info13_propietario_constitucion_servidumbre_juridico where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info14_saneamiento_basico">
        <sql>
        select * from info14_saneamiento_basico where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info14_saneamiento_juridico">
        <sql>
        select * from info14_saneamiento_juridico_vw where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info14_infraestructura_servidumbre">
        <sql>
        select * from servidumbres.info14_infraestructura_servidumbre where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="info15_saneamiento_juridico">
        <sql>
        select * from info15_saneamiento_juridico where id_expediente=$id_expediente 
        </sql>
    </Consulta>
    <Consulta id="info15_areas">
        <sql>
        select * from info15_areas where id_expediente=$id_expediente 
        </sql>
    </Consulta>
    <Consulta id="info15_saneamiento_basico_servidumbre">
        <sql>
        select * from servidumbres.info15_saneamiento_basico_servidumbre where id_servidumbre=$id_servidumbre 
        </sql>
    </Consulta>
    <Consulta id="info16_tributaria">
        <sql>
        select * from info16_tributaria where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info16_municipios_intersectados_servidumbre">
        <sql>
        select * from servidumbres.info16_municipios_intersectados_servidumbre where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo
        </sql>
    </Consulta>

    <Consulta id="info17_documentos_requeridos">
        <sql>
        select * from info17_documentos_requeridos where id_expediente=$id_expediente
        and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info17_documentos_requeridos_servidumbre">
        <sql>
        select * from servidumbres.info17_documentos_requeridos_servidumbre where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="info18_municipios_intersectados">
        <sql>
        select * from info18_municipios_intersectados where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info18_control_calidad_tecnico_servidumbre">
        <sql>
        select * from servidumbres.info18_control_calidad_tecnico_servidumbre where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="info19_mutacion_predial">
        <sql>
        select * from info19_mutacion_predial where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info19_estado_saneamiento_basico_servidumbre">
        <sql>
        select * from servidumbres.info19_estado_saneamiento_basico_servidumbre where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info20_documentos_requeridos_juridico">
        <sql>
        select * from info20_documentos_requeridos_juridico where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info20_sig_servidumbre">
        <sql>
        select * from servidumbres.info20_sig_servidumbre where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="info21_juridicos">
        <sql>
        select * from info21_juridicos where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info22_factura_municipio">
        <sql>
        select * from info22_factura_municipio where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info23_sig">
        <sql>
        select * from info23_sig where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info24_social">
        <sql>
        select * from info24_social where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info25_unidades_sociales">
        <sql>
        select * from info25_unidades_sociales where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info26_personas_unidad_social">
        <sql>
        select * from info26_personas_unidad_social where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info27_servicios_publicos">
        <sql>
        select * from info27_servicios_publicos where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info28_avaluo_actividad_economica">
        <sql>
        select * from info28_avaluo_actividad_economica where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info29_compensaciones_y_reconocimientos_economicos">
        <sql>
        select * from info29_compensaciones_y_reconocimientos_economicos where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info30_liquidacion_dano_emergente_y_lucrocesante">
        <sql>
        select * from info30_liquidacion_dano_emergente_y_lucrocesante where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info31_acta_de_aceptacion">
        <sql>
        select * from info31_acta_de_aceptacion where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info32_negociacion_construcciones">
        <sql>
        select * from info32_negociacion_construcciones where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info33_reasentamiento">
        <sql>
        select * from info33_reasentamiento where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info34_estado_saneamiento_basico">
        <sql>
        select * from i34_estado_saneamiento_basico_vw where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info35_estado_saneamiento_juridico">
        <sql>
        select * from i35_estado_saneamiento_juridico_vw where id_expediente=$id_expediente and consecutivo=$consecutivo
        </sql>
    </Consulta>
    <Consulta id="info36_documental">
        <sql>
        select * from info36_documental where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info37_prestamo_expedientes">
        <sql>
        select * from info37_prestamo_expedientes where id_expediente=$id_expediente and consecutivo = $consecutivo
        </sql>
    </Consulta>
     <Consulta id="info38_financiero">
        <sql>
        select * from info38_financiero where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info39_gestion_san_tec">
        <sql>
        select * from info39_gestion_san_tec_vw where id_expediente=$id_expediente and consecutivo = $consecutivo
        </sql>
    </Consulta>
    <Consulta id="info40_san_jur">
        <sql>
        select * from info40_san_jur where id_expediente=$id_expediente and consecutivo = $consecutivo
        </sql>
    </Consulta>
    <Consulta id="info41_observaciones_predio">
        <sql>
        select * from info41_observaciones_predio_vw where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info41_adquisicion_matrices">
        <sql>
        select * from info41_adquisicion_matrices_vw where id_expediente=$id_expediente and consecutivo = $consecutivo
        </sql>
    </Consulta>
    <Consulta id="info42_adquisicion_tradentes">
        <sql>
        select * from info42_adquisicion_tradentes where id_expediente=$id_expediente and consecutivo = $consecutivo
        </sql>
    </Consulta>
    <Consulta id="info43_contabilidad">
        <sql>
        select * from info43_contabilidad where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="info44_asignacion_saneamiento">
        <sql>
        select * from info44_asignacion_saneamiento where id_expediente=$id_expediente
        </sql>
    </Consulta>

    <Consulta id="get_proyectos">
        <sql>
        select distinct ig.id_expediente,calculo_matricula, mun.descripcion as departamento, dep.descripcion as municipio,
        iic.direccion_actual_igac 
		from info1_fuente ig left join info2_adquisicion_vw ip
		on ig.id_expediente=ip.id_expediente
		left join info4_informacion_catastral iic
        on ig.id_expediente=iic.id_expediente
        left join info42_adquisicion_tradentes iat on ig.id_expediente = iat.id_expediente 
        left join dominios dep on iic.departamento = dep.valor and dep.dominio = 'DOM_DEPTO'
        left join dominios mun on iic.municipio = mun.valor and mun.dominio = 'DOM_MUNICIPIO'
        where 
        upper(ig.id_expediente) like  upper('%' || $filtro || '%') 
        or 
        upper(calculo_matricula) like  upper('%' || $filtro || '%') 
        or 
        upper(iat.tradente) like  upper('%' || $filtro || '%') 
        or 
        upper(ip.serial_titulo) like  upper('%' || $filtro || '%') 
         or 
        ip.fecha_titulo::text like  ('%' || $filtro || '%')
        order by ig.id_expediente
        limit 50
        </sql>
    </Consulta>
    <Consulta id="get_servidumbres">
        <sql>
        select ig.id_servidumbre,id_proyecto_s,nom_proy_res,chip_cat,direccion,bar_ver, matricula from servidumbres.info1_general_proyecto_servidumbre ig 
        left join servidumbres.info2_general_predio_sirviente ip
        on ig.id_servidumbre=ip.id_servidumbre
        where 
        upper(ig.id_servidumbre) like  upper('%' || $filtro || '%') 
        or 
        upper(id_proyecto_s) like  upper('%' || $filtro || '%') 
        or 
        upper(nom_proy_res) like upper('%' || $filtro || '%') 
        or 
        upper(chip_cat) like upper('%' || $filtro || '%') 
        or 
        upper(matricula) like upper('%' || $filtro || '%')
        or 
        upper(cedula_catastral) like upper('%' || $filtro || '%')
        or 
        upper(bar_ver) like upper('%' || $filtro || '%')
        or 
        upper(upz_upr) like upper('%' || $filtro || '%')
        or 
        upper(direccion) like upper('%' || $filtro || '%')
        limit 50
        </sql>
    </Consulta>
    <Consulta id="update_info1_general_proyecto">
        <sql>
            update info1_general_proyecto set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info1_fuente">
        <sql>
            update info1_fuente set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info1_general_proyecto_servidumbre">
        <sql>
            update servidumbres.info1_general_proyecto_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info2_general_predio">
        <sql>
            update info2_general_predio set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info2_adquisicion">
        <sql>
            update info2_adquisicion set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info2_general_predio_sirviente">
        <sql>
            update servidumbres.info2_general_predio_sirviente set upd_query_alpaca where id_servidumbre=$id_servidumbre RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info3_areas_usos">
        <sql>
            update info3_areas_usos set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info3_predios_segregados">
        <sql>
            update info3_predios_segregados set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info3_general_predios_derivados">
        <sql>
            update servidumbres.info3_general_predios_derivados set upd_query_alpaca where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info4_avaluos">
        <sql>
            update info4_avaluos set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info4_informacion_catastral">
        <sql>
            update info4_informacion_catastral set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info4_areas_y_usos_predio_sirviente">
        <sql>
            update servidumbres.info4_areas_y_usos_predio_sirviente set upd_query_alpaca where id_servidumbre=$id_servidumbre RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info5_juridicos">
        <sql>
            update info5_juridicos set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info5_informacion_invias">
        <sql>
            update info5_informacion_invias set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info5_servidumbre">
        <sql>
            update servidumbres.info5_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info6_propietario_anterior_juridico">
        <sql>
            update info6_propietario_anterior_juridico set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info6_avaluos">
        <sql>
            update info6_avaluos set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info6_avaluos_servidumbre">
        <sql>
            update servidumbres.info6_avaluos_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info7_propietario_catastral">
        <sql>
            update info7_propietario_catastral set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info7_control_calidad_juridico">
        <sql>
            update info7_control_calidad_juridico set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info7_orden_de_pago">
        <sql>
            update servidumbres.info7_orden_de_pago set upd_query_alpaca where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info8_propietario_juridico">
        <sql>
            update info8_propietario_juridico set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info8_control_calidad_catastral">
        <sql>
            update info8_control_calidad_catastral set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info8_soportes_pago">
        <sql>
            update servidumbres.info8_soportes_pago set upd_query_alpaca where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info9_zmpa">
        <sql>
            update info9_zmpa set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info9_juridico_servidumbre">
        <sql>
            update servidumbres.info9_juridico_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info10_infraestructura">
        <sql>
            update info10_infraestructura set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info10_sig">
        <sql>
            update info10_sig set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info10_cons_servidumbre">
        <sql>
            update servidumbres.info10_cons_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo RETURNING id_servidumbre
        </sql>
    </Consulta>

    <Consulta id="update_info11_estudios_detallados">
        <sql>
            update info11_estudios_detallados set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info11_adquisicion_escritura">
        <sql>
            update info11_adquisicion_escritura set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info11_propietario_catastral">
        <sql>
            update servidumbres.info11_propietario_catastral set upd_query_alpaca where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info12_control_calidad_tecnico">
        <sql>
            update info12_control_calidad_tecnico set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info12_pago">
        <sql>
            update info12_pago set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info12_propietario_juridico_actual">
        <sql>
            update servidumbres.info12_propietario_juridico_actual set upd_query_alpaca where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo RETURNING id_servidumbre
        </sql>
    </Consulta>

    <Consulta id="update_info13_control_calidad_juridico">
        <sql>
            update info13_control_calidad_juridico set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info13_saneamiento_catastral">
        <sql>
            update info13_saneamiento_catastral set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info13_propietario_constitucion_servidumbre_juridico">
        <sql>
            update servidumbres.info13_propietario_constitucion_servidumbre_juridico set upd_query_alpaca where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info14_saneamiento_basico">
        <sql>
            update info14_saneamiento_basico set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info14_saneamiento_juridico">
        <sql>
            update info14_saneamiento_juridico set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info14_infraestructura_servidumbre">
        <sql>
            update servidumbres.info14_infraestructura_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info15_saneamiento_juridico">
        <sql>
            update info15_saneamiento_juridico set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info15_areas">
        <sql>
            update info15_areas set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info15_saneamiento_basico_servidumbre">
        <sql>
            update servidumbres.info15_saneamiento_basico_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info16_tributaria">
        <sql>
            update info16_tributaria set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info16_municipios_intersectados_servidumbre">
        <sql>
            update servidumbres.info16_municipios_intersectados_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info17_documentos_requeridos">
        <sql>
            update info17_documentos_requeridos set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info17_documentos_requeridos_servidumbre">
        <sql>
            update servidumbres.info17_documentos_requeridos_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info18_municipios_intersectados">
        <sql>
            update info18_municipios_intersectados set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info18_control_calidad_tecnico_servidumbre">
        <sql>
            update servidumbres.info18_control_calidad_tecnico_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info19_mutacion_predial">
        <sql>
            update info19_mutacion_predial set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info19_estado_saneamiento_basico_servidumbre">
        <sql>
            update servidumbres.info19_estado_saneamiento_basico_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre and consecutivo=$consecutivo RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info20_documentos_requeridos_juridico">
        <sql>
            update info20_documentos_requeridos_juridico set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info20_sig_servidumbre">
        <sql>
            update servidumbres.info20_sig_servidumbre set upd_query_alpaca where id_servidumbre=$id_servidumbre RETURNING id_servidumbre
        </sql>
    </Consulta>
    <Consulta id="update_info21_juridicos">
        <sql>
            update info21_juridicos set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info22_factura_municipio">
        <sql>
            update info22_factura_municipio set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info23_sig">
        <sql>
            update info23_sig set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info24_social">
        <sql>
            update info24_social set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info25_unidades_sociales">
        <sql>
            update info25_unidades_sociales set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info26_personas_unidad_social">
        <sql>
            update info26_personas_unidad_social set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info27_servicios_publicos">
        <sql>
            update info27_servicios_publicos set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info28_avaluo_actividad_economica">
        <sql>
            update info28_avaluo_actividad_economica set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
     <Consulta id="update_info29_compensaciones_y_reconocimientos_economicos">
        <sql>
            update info29_compensaciones_y_reconocimientos_economicos set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info30_liquidacion_dano_emergente_y_lucrocesante">
        <sql>
            update info30_liquidacion_dano_emergente_y_lucrocesante set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info31_acta_de_aceptacion">
        <sql>
            update info31_acta_de_aceptacion set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info32_negociacion_construcciones">
        <sql>
            update info32_negociacion_construcciones set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info33_reasentamiento">
        <sql>
            update info33_reasentamiento set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info34_estado_saneamiento_basico">
        <sql>
            update info34_estado_saneamiento_basico set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info35_estado_saneamiento_juridico">
        <sql>
            update info35_estado_saneamiento_juridico set upd_query_alpaca where id_expediente=$id_expediente and consecutivo=$consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info36_documental">
        <sql>
            update info36_documental set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info37_prestamo_expedientes">
        <sql>
            update info37_prestamo_expedientes set upd_query_alpaca where id_expediente=$id_expediente and consecutivo = $consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info38_financiero">
        <sql>
            update info38_financiero set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info39_gestion_san_tec">
        <sql>
            update info39_gestion_san_tec set upd_query_alpaca where id_expediente=$id_expediente and consecutivo = $consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info40_san_jur">
        <sql>
            update info40_san_jur set upd_query_alpaca where id_expediente=$id_expediente and consecutivo = $consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info41_observaciones_predio">
        <sql>
            update info41_observaciones_predio set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info41_adquisicion_matrices">
        <sql>
            update info41_adquisicion_matrices set upd_query_alpaca where id_expediente=$id_expediente and consecutivo = $consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info42_adquisicion_tradentes">
        <sql>
            update info42_adquisicion_tradentes set upd_query_alpaca where id_expediente=$id_expediente and consecutivo = $consecutivo RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info43_contabilidad">
        <sql>
            update info43_contabilidad set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_info44_asignacion_saneamiento">
        <sql>
            update info44_asignacion_saneamiento set upd_query_alpaca where id_expediente=$id_expediente RETURNING id_expediente
        </sql>
    </Consulta>



    <Consulta id="get_campos_repositorio">
        <sql>
            select
            json_build_object(
                'nombre_documento',nombre,
                'codigo', codigo,
                'field', campo,
                'helper', descripcion,
                'type',tipo,
                'required',obligatorio
                ) as doc
            from 
            (
            select concat(ds.cod_grupo,ds.cod_subgrupo) AS CODIGO,* from doc_grupo dg 
            INNER join doc_subgrupo ds 
            on dg.cod_grupo=ds.cod_grupo
            where ds.cod_grupo =$cod_grupo) as sub
        </sql>
    </Consulta>

    <Consulta id="insertar_repositorio">
        <sql>
           INSERT INTO repositorio_documental 
            VALUES ($id_expediente, $codigo_documento,$atributos,$doc_nombre)
            ON CONFLICT (id_expediente, codigo_documento) DO UPDATE
            SET atributos = $atributos,doc_nombre=$doc_nombre
        </sql>
    </Consulta>

    <Consulta id="get_documentos">
        <sql>
            select * from documentos where identificador=$identificador
        </sql>
    </Consulta>


    <Consulta id="get_datos_repositorio">
        <sql>
        select atributos from repositorio_documental
        where id_expediente=$id_expediente
        and codigo_documento=$codigo_documento
        </sql>
    </Consulta>

    <Consulta id="get_usuarios_rol">
        <sql>
        select usuario_nombre,usuario_usuario from usuario where usuario_rol=$usuario_rol
        </sql>
    </Consulta>
    <Consulta id="get_usuarios_rol_tecnico">
        <sql>
        select usuario_nombre,usuario_usuario from usuario where usuario_rol in(7,9)
        </sql>
    </Consulta>
    <Consulta id="get_usuarios_rol_juridico">
        <sql>
        select usuario_nombre,usuario_usuario from usuario where usuario_rol=10
        </sql>
    </Consulta>
    <Consulta id="get_usuarios">
        <sql>
        select usuario_nombre,usuario_usuario from usuario
        </sql>
    </Consulta>
    <Consulta id="get_usuarios_lista">
        <sql>
        select u.usuario_usuario as username, u.usuario_rol as id_rol, r.descripcion as rol,
            u.usuario_nombre as nombre, u.usuario_correo as correo,
            u.usuario_cargo as cargo,u.usuario_contrato as contrato
            from usuario u join rol r on u.usuario_rol = r.id_rol
        </sql>
    </Consulta>
    <Consulta id="get_roles_lista">
        <sql>
        select *
        from rol
        </sql>
    </Consulta>
    <Consulta id="get_formulario">
        <sql>
        select
        json_build_object(
            'field',field,
            'form',form,
            'label', label,
            'type', type,
            'size', size,
            'helper',helper,
            'enum',CASE
				WHEN m.caso_especial = 'accion_saneamiento' THEN c.enum
                WHEN m.caso_especial = 'accion_saneamiento_jur' THEN e.enum
				ELSE 
					case
						when m.rol_edicion = 10 then u.enum
						when m.rol_edicion = 14 then usc.enum
						WHEN d.enum is not null then d.enum
						ELSE NULL
					END
			END,
            'editable',editable,
            'regex',regex,
            'message',message,
            'listener',listener,
            'id_consulta',id_consulta,
            'external_field',external_field,
            'field_child', field_child,
			'child_domain',child_domain,
			'field_father',field_father,
			'father_domain',father_domain,
            'enum_name',m.enum,
            'caso_especial',m.caso_especial,
            'rol_edicion', m.rol_edicion,
            'required', m.required,
            'moneda', m.moneda,
            'min_size', m.min_size
            ) as doc
        from modulos m left join (select dominio,
								  json_agg(json_build_object('value',valor,'label',descripcion,'padre',dominio_padre,'padre_valor',dominio_padre_valor)) as enum
								  from dominios
group by dominio) as d
        on m.enum=d.dominio
        left join (select 'usuarios' as dominio,
								  json_agg(json_build_object('value',usuario_usuario,'label',usuario_nombre,'padre',null,'padre_valor',null)) as enum
								  from usuario where usuario_rol = 10) as u
        on m.enum=u.dominio
        left join (select 'usuarios' as dominio,
								  json_agg(json_build_object('value',usuario_usuario,'label',usuario_nombre,'padre',null,'padre_valor',null)) as enum
								  from usuario where usuario_rol = 14) as usc
        on m.enum=usc.dominio
        left join (select dominio,
				  json_agg(json_build_object('value',valor,'label',concat(gestion_san,' - ',descripcion),'padre',dominio_padre,'padre_valor',dominio_padre_valor)) as enum
				  from dominios a join (
				  select a.id_expediente,a.accion_saneamiento,
				case 
					when b.id_expediente is not null then 'GESTIONADO'
					else 'NO GESTIONADO'
				end as gestion_san
				from (select id_expediente, UNNEST(saneamientos_catastrales) as accion_saneamiento
					from info13_saneamiento_catastral isb 
					where id_expediente = $id_expediente) as a
					left join 
				(select id_expediente, accion_saneamiento 
				from info39_gestion_san_tec igst 
				where id_expediente = $id_expediente) as b on a.id_expediente = b.id_expediente and a.accion_saneamiento = b.accion_saneamiento) as b on a.valor = b.accion_saneamiento
			  		where b.id_expediente = $id_expediente
					group by a.dominio) as c on m.enum=c.dominio
        left join (select dominio,
				  json_agg(json_build_object('value',valor,'label',concat(gestion_san,' - ',descripcion),'padre',dominio_padre,'padre_valor',dominio_padre_valor)) as enum
				  from dominios a join (
				  select a.id_expediente,a.accion_saneamiento,
				case 
					when b.id_expediente is not null then 'GESTIONADO'
					else 'NO GESTIONADO'
				end as gestion_san
				from (select id_expediente, UNNEST(saneamientos) as accion_saneamiento
					from info14_saneamiento_juridico
					where id_expediente = $id_expediente) as a
					left join 
				(select id_expediente, saneamiento 
				from info40_san_jur igsj
				where id_expediente = $id_expediente) as b on a.id_expediente = b.id_expediente and a.accion_saneamiento = b.saneamiento) as b on a.valor = b.accion_saneamiento
			  		where b.id_expediente = $id_expediente
					group by a.dominio) as e on m.enum=e.dominio
        where tabla=$tabla order by orden;
        </sql>
    </Consulta>

    <Consulta id="get_formulario_servidumbre">
        <sql>
        select
        json_build_object(
            'field',field,
            'form',form,
            'label', label,
            'type', type,
            'size', size,
            'helper',helper,
            'enum',d.enum,
            'editable',editable,
            'regex',regex,
            'message',message,
            'listener',listener,
            'id_consulta',id_consulta,
            'external_field',external_field,
            'field_child', field_child,
			'child_domain',child_domain,
			'field_father',field_father,
			'father_domain',father_domain,
            'enum_name',m.enum
            ) as doc
        from servidumbres.modulos m left join (select dominio,
								  json_agg(json_build_object('value',valor,'label',descripcion,'padre',dominio_padre,'padre_valor',dominio_padre_valor)) as enum
								  from dominios
group by dominio) as d
        on m.enum=d.dominio
        where tabla=$tabla order by orden
        </sql>
    </Consulta>
    <Consulta id="session">
        <sql>
        select * from usuario
        where usuario_usuario=token
        </sql>
    </Consulta>

    <Consulta id="insertar_asignacion">
        <sql>
        insert into tareas.asignacion values (
            $id_expediente,
            $id_tarea,
            (select usuario from tareas.grupos 
            where id_tarea=$id_tarea and id_grupo=(select id_grupo from usuario where usuario_usuario=$usuario_responsable))
        )
        ON CONFLICT DO NOTHING;
        </sql>
    </Consulta>
    <Consulta id="insertar_asignacion_tecnico">
        <sql>
        insert into tareas.asignacion values (
            $id_expediente,
            $id_tarea,
            $usuario_responsable
        )
        ON CONFLICT (id_expediente,id_tarea) DO UPDATE
            SET usuario = $usuario_responsable
            returning id_expediente
        </sql>
    </Consulta>
    <Consulta id="update_notificacion">
        <sql>
        update tareas.tareas
        set fecha_asignacion = now(), usuario_responsable = $usuario_responsable
        where ruta = $ruta and id_expediente = $id_expediente and estado = 1
        returning id_expediente;
        </sql>
    </Consulta>

    <Consulta id="insertar_notificacion">
        <sql>
        insert into tareas.tareas values(
            (select max (id)+1 from tareas.tareas),
            $id_expediente,
            $ruta_destino,
            token,
            (select usuario from tareas.asignacion 
            where id_expediente=$id_expediente and id_tarea= $tarea_next),
            now(),
            null,
            1,
            true
        )ON CONFLICT DO NOTHING RETURNING usuario_responsable
        </sql>
    </Consulta>
    <Consulta id="insertar_notificacion_documental">
        <sql>
        insert into tareas.tareas values(
            (select max (id)+1 from tareas.tareas),
            $id_expediente,
            $ruta_destino,
            $usuario,
            (select usuario from tareas.asignacion 
            where id_expediente=$id_expediente and id_tarea= $tarea_next),
            now(),
            null,
            1,
            true
        )ON CONFLICT DO NOTHING RETURNING usuario_responsable
        </sql>
    </Consulta>



    <Consulta id="aprobado_juridico">
        <sql>
        SELECT CASE WHEN EXISTS (
            SELECT aprobado
            from info7_control_calidad_juridico 
            where id_expediente=$id_expediente
        )
        THEN
            (select CASE WHEN aprobado=1 THEN true
                    ELSE false
            END
        from info7_control_calidad_juridico 
        where id_expediente=$id_expediente)
        ELSE
            false
        END as aprobado
        </sql>
    </Consulta>
    <Consulta id="aprobado_juridico_saneamiento">
        <sql>
        SELECT CASE WHEN EXISTS (
            SELECT apro_bor_salida_j
            from info40_gestion_san_jur
            where id_expediente=$id_expediente
            and consecutivo = $consecutivo
        )
        THEN
            (select CASE WHEN apro_bor_salida_j=1 THEN true
                    ELSE false
            END
        from info40_gestion_san_jur
        where id_expediente=$id_expediente
            and consecutivo = $consecutivo)
        ELSE
            false
        END as aprobado;
        </sql>
    </Consulta>
    <Consulta id="aprobado_juridico_saneamiento_final">
        <sql>
        SELECT CASE WHEN EXISTS (
            SELECT aprobacion_gestion_j
            from info40_gestion_san_jur
            where id_expediente=$id_expediente
            and consecutivo = $consecutivo
        )
        THEN
            (select CASE WHEN aprobacion_gestion_j=1 THEN true
                    ELSE false
            END
        from info40_gestion_san_jur
        where id_expediente=$id_expediente
            and consecutivo = $consecutivo)
        ELSE
            false
        END as aprobado;
        </sql>
    </Consulta>
    <Consulta id="aprobado_tecnico">
        <sql>
        SELECT CASE WHEN EXISTS (
            SELECT aprobado
            from info8_control_calidad_catastral 
            where id_expediente=$id_expediente
        )
        THEN
            (select CASE WHEN aprobado=1 THEN true
                    ELSE false
            END
        from info8_control_calidad_catastral 
        where id_expediente=$id_expediente)
        ELSE
            false
        END as aprobado
        </sql>
    </Consulta>
    <Consulta id="aprobado_tecnico_saneamiento">
        <sql>
        SELECT CASE WHEN EXISTS (
            SELECT apro_bor_salida_t
            from info39_gestion_san_tec
            where id_expediente=$id_expediente
            and consecutivo = $consecutivo
        )
        THEN
            (select CASE WHEN apro_bor_salida_t=1 THEN true
                    ELSE false
            END
        from info39_gestion_san_tec 
        where id_expediente=$id_expediente
        and consecutivo = $consecutivo)
        ELSE
            false
        END as aprobado;
        </sql>
    </Consulta>
    <Consulta id="aprobado_tecnico_saneamiento_final">
        <sql>
        SELECT CASE WHEN EXISTS (
            SELECT aprobacion_gestion_t 
            from info39_gestion_san_tec
            where id_expediente=$id_expediente
            and consecutivo = $consecutivo
        )
        THEN
            (select CASE WHEN aprobacion_gestion_t=1 THEN true
                    ELSE false
            END
        from info39_gestion_san_tec 
        where id_expediente=$id_expediente
        and consecutivo = $consecutivo)
        ELSE
            false
        END as aprobado;
        </sql>
    </Consulta>
    <Consulta id="procede_saneamiento_tecnico">
        <sql>
        SELECT CASE WHEN EXISTS (
            SELECT proc_san_t 
            from info39_gestion_san_tec
            where id_expediente=$id_expediente
            and consecutivo = $consecutivo
        )
        THEN
            (select CASE WHEN proc_san_t=1 THEN true
                    ELSE false
            END
        from info39_gestion_san_tec 
        where id_expediente=$id_expediente
        and consecutivo = $consecutivo)
        ELSE
            false
        END as aprobado;
        </sql>
    </Consulta>
    <Consulta id="procede_saneamiento_juridico">
        <sql>
        SELECT CASE WHEN EXISTS (
            SELECT proc_san_j 
            from info40_gestion_san_jur igsj 
            where id_expediente=$id_expediente
            and consecutivo = $consecutivo
        )
        THEN
            (select CASE WHEN proc_san_j=1 THEN true
                    ELSE false
            END
        from info40_gestion_san_jur 
        where id_expediente=$id_expediente
        and consecutivo = $consecutivo)
        ELSE
            false
        END as aprobado;
        </sql>
    </Consulta>
    <Consulta id="aprobado_tecnico_servidumbre">
        <sql>
        SELECT CASE WHEN EXISTS (
            SELECT aprobado
            from servidumbres.info18_control_calidad_tecnico_servidumbre
            where id_servidumbre=$id_expediente
        )
        THEN
            (select CASE WHEN aprobado=1 THEN true
                    ELSE false
            END
        from servidumbres.info18_control_calidad_tecnico_servidumbre
        where id_servidumbre=$id_expediente)
        ELSE
            false
        END as aprobado
        </sql>
    </Consulta>




    <Consulta id="get_tareas">
        <sql>
        select *,
        null as consecutivo,
        null as tabla,
        (select descripcion from tareas.flujo as tf where
        tf.ruta=t.ruta), 
        (select usuario_nombre from usuario as u where
        u.usuario_usuario=t.usuario_asigna)as usuario_nombre,
        (select usuario_nombre from usuario as u where
        u.usuario_usuario=t.usuario_responsable)as usuario_responsable
        from tareas.tareas as t
        where
        usuario_responsable=token and estado=1 and visible=true
		union
        select *,
        (select descripcion from tareas.flujo_saneamientos as tf where
        tf.ruta=t.ruta), 
        (select usuario_nombre from usuario as u where
        u.usuario_usuario=t.usuario_asigna)as usuario_nombre,
        (select usuario_nombre from usuario as u where
        u.usuario_usuario=t.usuario_responsable)as usuario_responsable
        from tareas.tareas_saneamientos as t
        where
        usuario_responsable=token and estado=1 and visible=true
        order by fecha_asignacion desc;
        </sql>
    </Consulta>

    <Consulta id="update_tareas_estado">
        <sql>
        update tareas.tareas set estado=2, fecha_solucion=now() 
        where id=$id 
        returning id_expediente
        </sql>
    </Consulta>

    <Consulta id="update_tareas_estado_saneamientos">
        <sql>
        update tareas.tareas_saneamientos set estado=2, fecha_solucion=now() 
        where id=$id 
        returning id_expediente
        </sql>
    </Consulta>

    <Consulta id="update_tareas_estado_documental">
        <sql>
        update tareas.tareas set estado=2, fecha_solucion=now() 
        where id_expediente = $id_expediente and usuario_asigna = $usuario_prestamo 
        and ruta = 13
        returning id_expediente
        </sql>
    </Consulta>


    <Consulta id="get_numero_tareas">
        <sql>
        select sum(conteo) count
       from (
       select count(*) conteo
       from tareas.tareas 
        where usuario_responsable=token and estado=1
        union
        select count(*) conteo from tareas.tareas_saneamientos 
        where usuario_responsable=token and estado=1) as a
        </sql>
    </Consulta>

    <Consulta id="get_historia_expediente">
        <sql>
            select *,
            (select usuario_cargo from usuario u where
            u.usuario_usuario=e.usuario_usuario),
            (select usuario_nombre from usuario u where
            u.usuario_usuario=e.usuario_usuario)
            from seguimiento_expedientes e
            where id_expediente=$id_expediente order by iteracion
        </sql>
    </Consulta>


    <Consulta id="asignar_expediente_fisico_paso1">
        <sql>
            update seguimiento_expedientes set fecha_final=now()
            ,activo=false where id_expediente=$id_expediente
            and activo=true;
        </sql>
    </Consulta>
    <Consulta id="asignar_expediente_fisico_paso2">
        <sql>
        insert into 
        seguimiento_expedientes(id_expediente,iteracion,
					    usuario_usuario,activo,fecha_inicio)
            select $id_expediente,
            (select max(iteracion)+1 from seguimiento_expedientes
            where id_expediente=$id_expediente ),
            $id_asignado,true,now();
        </sql>
    </Consulta>
    <Consulta id="get_datos_busqueda_geometria">
        <sql>
            select lotcodigo,chip,direccion_
            from geometria.tabla_lote_catastro 
            where lotcodigo like '%' || $lotcodigo || '%' or chip like '%' || $chip || '%'
            limit 20
        </sql>
    </Consulta>

    <Consulta id="get_geometria_busqueda">
        <sql>
        SELECT ST_AsGeoJSON(st_transform(geom,4326))as geom
        from geometria.lote_catastro
        where lotcodigo =$codigo
        </sql>
    </Consulta>
    <Consulta id="get_geometria_predio">
        <sql>
            SELECT 'geometria_verificada' as tipo,jsonb_build_object(
                'type',     'FeatureCollection',
                'features', jsonb_agg(features.Feature)
            )as geojson from (
            SELECT json_build_object(
                'type',       'Feature',
                'id',         id,
                'geometry',   ST_AsGeoJSON(ST_Transform(geom,4326))::json,
                'properties', json_build_object(
                    'id_expediente', id_expediente,
                    'estado', estado,
                    'id',id
                )
            ) as Feature
            FROM geometria.lote_asignacion where id_expediente = $id_expediente and (estado is null or estado = 2)
            )features
            union
            SELECT 'geometria_revision' as tipo,jsonb_build_object(
                'type',     'FeatureCollection',
                'features', jsonb_agg(features.Feature)
            )as geojson from (
            SELECT json_build_object(
                'type',       'Feature',
                'id',         id,
                'geometry',   ST_AsGeoJSON(ST_Transform(geom,4326))::json,
                'properties', json_build_object(
                    'id_expediente', id_expediente,
                    'estado', estado,
                    'id',id
                )
            ) as Feature
            FROM geometria.lote_asignacion where id_expediente = $id_expediente and estado in (1)
            )features
        </sql>
    </Consulta>
    <Consulta id="get_geometria_servidumbre">
        <sql>
            SELECT 'geometria_verificada' as tipo,jsonb_build_object(
                'type',     'FeatureCollection',
                'features', jsonb_agg(features.Feature)
            )as geojson from (
            SELECT json_build_object(
                'type',       'Feature',
                'id',         id,
                'geometry',   ST_AsGeoJSON(ST_Transform(geom,4326))::json,
                'properties', json_build_object(
                    'id_expediente', id_expedie,
                    'estado', estado,
                    'id',id
                )
            ) as Feature
            FROM geometria.servidumbre where id_expedie = $id_expediente and (estado is null or estado = 2)
            )features
            union
            SELECT 'geometria_revision' as tipo,jsonb_build_object(
                'type',     'FeatureCollection',
                'features', jsonb_agg(features.Feature)
            )as geojson from (
            SELECT json_build_object(
                'type',       'Feature',
                'id',         id,
                'geometry',   ST_AsGeoJSON(ST_Transform(geom,4326))::json,
                'properties', json_build_object(
                    'id_expediente', id_expedie,
                    'estado', estado,
                    'id',id
                )
            ) as Feature
            FROM geometria.servidumbre where id_expedie = $id_expediente and estado in (1)
            )features
        </sql>
    </Consulta>
    <Consulta id="get_geometria_predios">
        <sql>
            select json_build_object(
				'type',     'FeatureCollection',
                'features', jsonb_agg(features.Feature)
			) as geojson from
			(SELECT json_build_object(
                'type',       'Feature',
                'geometry',   ST_AsGeoJSON(ST_Transform(geom,4326))::json,
                'properties', json_build_object(
                    'id_expediente', id_expediente,
                    'cod_dup', cod_dup,
					'nom_proy', nom_proy,
					'chip_cat', chip_cat,
					'num_mi', num_mi,
					'ced_cat', ced_cat,
					'dir_act', dir_act
                )
            ) as Feature
			FROM (select pr.id_expediente, 
			dup.cod_dup,dup.nom_proy, pr.chip_cat, pr.num_mi,
			pr.ced_cat, pr.dir_act, lote.geom
			from info1_vw_dup dup 
			join info2_general_predio pr on dup.id_expediente = pr.id_expediente
			join geometria.lote_asignacion lote on pr.id_expediente = lote.id_expediente) as consulta) as features;
        </sql>
    </Consulta>
   <Consulta id="insertar_dibujo_mapa">
        <sql>
            insert into geometria.lote_asignacion (id,id_expediente,geom,estado)
            values((select max(id) + 1 from geometria.lote_asignacion),$id_expediente,ST_SetSRID(ST_Multi(ST_GeomFromGeoJSON($shape)),4326),$estado)
            returning id_expediente
        </sql>
    </Consulta>
    <Consulta id="insertar_dibujo_mapa_servidumbre">
        <sql>
            insert into geometria.servidumbre (id,id_expedie,geom,estado)
            values((select max(id) + 1 from geometria.servidumbre),$id_expediente,ST_SetSRID(ST_Multi(ST_GeomFromGeoJSON($shape)),4326),$estado)
            returning id_expedie
        </sql>
    </Consulta>

    <Consulta id="consultar_permisos">
        <sql>

            select p.id_permiso from usuario u
            inner join rol r on u.usuario_rol=r.id_rol
            left join rol_permisos rp on r.id_rol=rp.id_rol
            inner join permisos p on rp.id_permiso=p.id_permiso
            where usuario_usuario=token

        </sql>
    </Consulta>  

    <Consulta id="expediente_asignado">
        <sql>
        select exists (
        select id_expediente from tareas.tareas 
        where usuario_responsable=token and estado=1 and id_expediente=$id_expediente)
        </sql>
    </Consulta>   

    <Consulta id="reporte_tareas">
        <sql>
        select * from tareas.tareas where usuario_responsable=token
        </sql>
    </Consulta> 
    <Consulta id="reporte_documentos">
        <sql>
            select * from documentos
        </sql>
    </Consulta> 
    <Consulta id="reporte_info1_servidumbres">
        <sql>
            select *
                from servidumbres.info1_general_proyecto_servidumbre i1
                join (
                    SELECT *
                        FROM crosstab(
                            'select id_expediente,id_tarea,usuario_nombre
                            from tareas.asignacion t 
                            left join usuario u
                            on t.usuario=u.usuario_usuario
                            order by id_expediente,id_tarea'
                        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
                ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta> 
    <Consulta id="reporte_info2_servidumbres">
        <sql>
            select *
            from servidumbres.info2_general_predio_sirviente i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta> 
     <Consulta id="reporte_info3_servidumbres">
        <sql>
            select *
            from servidumbres.info3_general_predios_derivados i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta> 
    <Consulta id="reporte_info4_servidumbres">
        <sql>
            select *
            from servidumbres.info4_areas_y_usos_predio_sirviente i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta> 
    <Consulta id="reporte_info5_servidumbres">
        <sql>
            select *
            from servidumbres.info5_servidumbre i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info3_predios_segregados">
        <sql>
            select i1.id_expediente codigo_bupi, i1.consecutivo, i1.fmi_segregado, "Técnico" estructurador, "Sup. Técnico" control_calidad
            from info3_predios_segregados i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info6_avaluos">
        <sql>
            select i1.id_expediente codigo_bupi, i1.consecutivo, i1.avaluo, i1.vigencia, "Técnico" estructurador,"Sup. Técnico" control_calidad
            from info6_avaluos i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info7_control_calidad_juridico">
        <sql>
            select i1.id_expediente codigo_bupi, get_dominio('DOM_BINARIO'::text,i1.aprobado::text) aprobado, i1.observacion, "Técnico" estructurador,"Sup. Técnico" control_calidad
            from info7_control_calidad_juridico i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info8_control_calidad_catastral">
        <sql>
            select i1.id_expediente codigo_bupi, get_dominio('DOM_BINARIO'::text,i1.aprobado::text) aprobado, i1.observacion,"Técnico" estructurador,"Sup. Técnico" control_calidad
            from info8_control_calidad_catastral i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info42_adquisicion_tradentes">
        <sql>
            select i1.id_expediente codigo_bupi, i1.consecutivo, i1.tradente, get_dominio('DOM_TIPO_DOC'::text,i1.tipo_documento_tradente::text) tipo_documento_tradente, i1.numero_documento_tradente,"Técnico" estructurador,"Sup. Técnico" control_calidad
            from info42_adquisicion_tradentes i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info41_adquisicion_matrices">
        <sql>
             select i1.id_expediente codigo_bupi, i1.consecutivo, i1.orip_matriz, i1.fmi_matriz, i1.calculo_fmi_matriz,"Técnico" estructurador,"Sup. Técnico" control_calidad
            from info41_adquisicion_matrices i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info14_saneamiento_juridico">
        <sql>
            select i1.id_expediente codigo_bupi, i1.saneamientos,"Técnico" estructurador, "Sup. Técnico" control_calidad
            from info14_saneamiento_juridico i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info13_saneamiento_catastral">
        <sql>
            select i1.id_expediente codigo_bupi, i1.saneamientos_catastrales ,"Técnico" estructurador,"Sup. Técnico" control_calidad
            from info13_saneamiento_catastral i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info11_adquisicion_escritura">
        <sql>
           select i1.id_expediente codigo_bupi, i1.escritura , i1.caja , i1.carpeta ,i1.fecha_entrega_carpeta ,i1.proyecto_vial ,i1.convenio_contrato ,
           i1.fecha_cargue_teams , get_dominio('DOM_ESTADO_BUSQUEDA'::text,i1.estado_busqueda::text) estado_busqueda, i1.enlace_teams , i1.observacion_documental ,"Técnico" estructurador,"Sup. Técnico" control_calidad
            from info11_adquisicion_escritura i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info12_pago">
        <sql>
            select i1.id_expediente codigo_bupi, i1.consecutivo , i1.no_ficha_predial , i1.valor_pago , "Técnico" estructurador,"Sup. Técnico" control_calidad
            from info12_pago i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info15_areas">
        <sql>
            select *
            from info15_areas i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_expediente = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info6_servidumbres">
        <sql>
            select *
            from servidumbres.info6_avaluos_servidumbre i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta> 
    <Consulta id="reporte_info7_servidumbres">
        <sql>
            select *
            from servidumbres.info7_orden_de_pago i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info8_servidumbres">
        <sql>
            select *
            from servidumbres.info8_soportes_pago i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info9_servidumbres">
        <sql>
            select *
            from servidumbres.info9_juridico_servidumbre i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>  
    <Consulta id="reporte_info10_servidumbres">
        <sql>
            select *
            from servidumbres.info10_cons_servidumbre i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info11_servidumbres">
        <sql>
            select *
            from servidumbres.info11_propietario_catastral i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info12_servidumbres">
        <sql>
            select *
            from servidumbres.info12_propietario_juridico_actual i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info13_servidumbres">
        <sql>
            select *
            from servidumbres.info13_propietario_constitucion_servidumbre_juridico i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info14_servidumbres">
        <sql>
            select *
            from servidumbres.info14_infraestructura_servidumbre i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info15_servidumbres">
        <sql>
            select *
            from servidumbres.info15_saneamiento_basico_servidumbre i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info16_servidumbres">
        <sql>
            select *
            from servidumbres.info16_municipios_intersectados_servidumbre i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;

        </sql>
    </Consulta>
    <Consulta id="reporte_info17_servidumbres">
        <sql>
            select *
            from servidumbres.info17_documentos_requeridos_servidumbre i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info18_servidumbres">
        <sql>
            select *
            from servidumbres.info18_control_calidad_tecnico_servidumbre i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="reporte_info19_servidumbres">
        <sql>
            select *
            from servidumbres.info19_estado_saneamiento_basico_servidumbre i1
            join (
                SELECT *
                    FROM crosstab(
                        'select id_expediente,id_tarea,usuario_nombre
                        from tareas.asignacion t 
                        left join usuario u
                        on t.usuario=u.usuario_usuario
                        order by id_expediente,id_tarea'
                    ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
            ) sub on i1.id_servidumbre = sub.id_expediente;
        </sql>
    </Consulta>

    <Consulta id="reporte_info5">
        <sql>
        select * from info5_juridicos
        natural join info21_juridicos
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info6">
        <sql>
        select * from info6_propietario_anterior_juridico
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info7">
        <sql>
        select * from info7_propietario_catastral
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info8">
        <sql>
        select * from info8_propietario_juridico
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info9">
        <sql>
        select * from info9_zmpa
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info10">
        <sql>
        select * from info10_infraestructura
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info11">
        <sql>
        select * from info11_estudios_detallados
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info12">
        <sql>
        select * from info12_control_calidad_tecnico
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info13">
        <sql>
        select * from info13_control_calidad_juridico
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info14">
        <sql>
        select * from info14_saneamiento_basico
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info15">
        <sql>
        select * from info15_saneamiento_juridico
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
        <Consulta id="reporte_info17">
        <sql>
        select * from info17_documentos_requeridos
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info18">
        <sql>
        select * from info18_municipios_intersectados
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info19">
        <sql>
        select * from info19_mutacion_predial
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_info22">
        <sql>
        select * from info22_factura_municipio
        natural join(
        SELECT *
        FROM crosstab(
            'select id_expediente,id_tarea,usuario_nombre
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            order by id_expediente,id_tarea'
        ) AS ct(id_expediente TEXT, "Técnico" TEXT, "Jurídico" TEXT, "Sup. Juridico" TEXT, "Sup. Técnico" TEXT)
        )sub
        natural join (
        select id_expediente,nivel_prior as "Nivel de prioridad" from info2_general_predio
        )sub1
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="reporte_documental">
        <sql>
        select i2.id_expediente, i2.chip_cat, i2.num_mi, i2.dir_act,
        d.descripcion as ubicacion, i36.fecha_ubicacion, i36.tomos, i37.consecutivo, i37.fecha_sol_usu_prestamo,
        i37.fecha_ent_usu_prestamo, i37.fecha_dev_usu_prestamo, 
        (select usuario_nombre from usuario where usuario_usuario = i37.usuario_prestamo) as usuario_prestamo
        from info2_general_predio i2
        left join info36_documental i36 on i2.id_expediente = i36.id_expediente
        left join info37_prestamo_expedientes i37 on i36.id_expediente = i37.id_expediente
        left join dominios d on d.dominio = 'Ubi_exp' and d.valor::real = i36.ubicacion::real
        order by i2.id_expediente, i37.consecutivo;
        </sql>
    </Consulta>
    <Consulta id="reporte_carga_documental">
        <sql>
        select i2.id_expediente, i2.chip_cat, i2.num_mi, i2.dir_act,
        d.descripcion as ubicacion, i36.fecha_ubicacion, i36.tomos, u.usuario_usuario as usuario_carga,
		doc.fecha as fecha_carga
        from info2_general_predio i2
        left join info36_documental i36 on i2.id_expediente = i36.id_expediente
		left join (select distinct identificador,usuario,fecha::date from documentos doc) doc on i2.id_expediente = doc.identificador
		left join usuario u on doc.usuario = u.usuario_usuario and u.usuario_rol in (4,8)
        left join dominios d on d.dominio = 'Ubi_exp' and d.valor::real = i36.ubicacion::real
        order by i2.id_expediente;
        </sql>
    </Consulta>
    <Consulta id="get_asignacion">
        <sql>
            select id_tarea,usuario_nombre,usuario_cargo
            from tareas.asignacion t 
            left join usuario u
            on t.usuario=u.usuario_usuario
            where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="get_tipologia">
        <sql>
            select descripcion
            from info5_juridicos ij
            left join dominios d on ij.tipologia_impuesto_2021::text = d.valor
            and d.dominio = 'Tip_Impuestos_V'
            where ij.id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="get_estados_depuracion">
        <sql>
             select t.id_expediente, dep_tec, f_tec
            from estado_aprobacion_tecnico t
            where t.id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="get_estados_depuracion_servidumbres">
        <sql>
             select *
			    from servidumbres.estado_aprobacion_tecnico
                where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>




    <Consulta id="reporte_actividades">
        <sql>

        select *
        from reporte_actividades
        order by codigo_bupi
        </sql>
    </Consulta>

    <Consulta id="tributaria_principal">
        <sql>
        select
            I.id_expediente,
            CHIP_CAT,
            NUM_MI,
            (select split_part(descripcion,'-',2) AS MPIO from dominios where dominio='TABLA_MUNICIPIO' and valor=I.MPIO),
            DEST_IGAC,
            DEST_CAT,
            CED_CAT,
            DIR_ACT,
            FISCAL,
            COD_DUP,
            FECHA_ACTADM,
            OBJET_RES,
            AREAT_PREDIO,
            AREA_EP,
            AREA_CAT,
            AREA_FMI,
            AT_GEO,
            AREA_DEFINITIVA_DEPURACION,
            AREA_EN_ZMPA,
            AREA_FUERA_EN_ZMPA,
            K.TIPOLOGIA_IMPUESTO_2020 AS TIPOLOGIA_ZMPA_2020,
            K.TIPOLOGIA_IMPUESTO_2021 AS TIPOLOGIA_ZMPA_2021,
            L.TIPOLOGIA_IMPUESTO_2020 AS TIPOLOGIA_IMPUESTOS_VIGENCIA_2020,
            L.TIPOLOGIA_IMPUESTO_2021 AS TIPOLOGIA_IMPUESTOS_VIGENCIA_2021,
            VAL_TOT_AV_CAT
            from info2_general_predio I 
            LEFT JOIN info1_general_proyecto J 
            on I.id_expediente=J.id_expediente
            LEFT JOIN info3_areas_usos K
            on I.id_expediente=K.id_expediente	  
            LEFT JOIN info5_juridicos L
            on I.id_expediente=L.id_expediente
            LEFT JOIN info4_avaluos M	  
            on I.id_expediente=M.id_expediente
            order by id_expediente
        </sql>
    </Consulta>


    <Consulta id="tributaria_zmpa">
        <sql>
        select
        id_expediente,
        consecutivo,
        ACTADM_ZMPA 
        from info9_zmpa
        order by id_expediente
        </sql>
    </Consulta>
    <Consulta id="tributaria_juridico">
        <sql>
        select 
        id_expediente,
        consecutivo,
        porcent_prop 
        from info21_juridicos
        order by id_expediente
        </sql>
    </Consulta>



    <Consulta id="estadistica1">
        <sql>
        SELECT COUNT(*) as estadistica 
            from (select distinct identificador
            from documentos doc
            join usuario u on doc.usuario = u.usuario_usuario
            where u.usuario_rol = 8) as temp;
        </sql>
    </Consulta>
    <Consulta id="estadistica2">
        <sql>
        select count(*) as estadistica from documentos
        </sql>
    </Consulta>
    <Consulta id="estadistica3">
        <sql>
        select count(*) as estadistica from info12_control_calidad_tecnico
        where aprobado =1
        </sql>
    </Consulta>
    <Consulta id="estadistica4">
        <sql>
        select count(*) as estadistica from auditoria
        </sql>
    </Consulta>
    <Consulta id="estadistica5">
        <sql>
        select count(*) as estadistica from info13_control_calidad_juridico
        where aprobado =1
        </sql>
    </Consulta>
    <Consulta id="estadistica6">
        <sql>
        select count(*) as estadistica from info14_saneamiento_basico
        </sql>
    </Consulta>
    <Consulta id="estadistica7">
        <sql>
        select count(*) as estadistica from info15_saneamiento_juridico
        </sql>
    </Consulta>
    <Consulta id="estadistica8">
        <sql>
        select count(*) as estadistica from info9_zmpa
        </sql>
    </Consulta>





    <Consulta id="grafico1">
        <sql>
            select array_agg(grupo) as categoria,array_agg(cuenta)as data from(
            select zona as grupo, count(zona)as cuenta from info2_general_predio 
            where zona is not null group by zona)sub
        </sql>
    </Consulta>
    <Consulta id="grafico2">
        <sql>
            select array_agg(grupo) as categoria,array_agg(cuenta)as data from(
            select clas_suelo as grupo, count(clas_suelo)as cuenta from info2_general_predio 
            where clas_suelo is not null group by clas_suelo)sub
        </sql>
    </Consulta>
    <Consulta id="grafico3">
        <sql>
        select array_agg(grupo) as categoria,array_agg(cuenta)as data from(
        select tipologia_impuesto_2020 as grupo, count(tipologia_impuesto_2020)as cuenta from info3_areas_usos
        where tipologia_impuesto_2020 is not null group by tipologia_impuesto_2020)sub	
        </sql>
    </Consulta>
    <Consulta id="grafico4">
        <sql>
            select fecha::date as grupo, count(fecha::date)as cuenta from auditoria 
            group by fecha::date order by fecha::date
        </sql>
    </Consulta>
    <Consulta id="grafico5">
        <sql>
        select array_agg(grupo) as categoria,array_agg(cuenta)as data from(
            select nivel_prior as grupo, count(nivel_prior)as cuenta from info2_general_predio 
            where nivel_prior is not null group by nivel_prior)sub
        </sql>
    </Consulta>

    <Consulta id="grafico6">
        <sql>
        select array_agg(grupo) as categoria,array_agg(cuenta)as data from(
        select caso as grupo, count(caso)as cuenta from (

        select sub1.id_expediente,
        (case when aprobado=1 then 'APROBADO' 
         when aprobado=2 then 
            CASE WHEN COALESCE(sub3.id_expediente, '') != '' THEN 'EN REVISIÓN' ELSE 'DEVUELTO' END
        ELSE  (case when coalesce(sub3.id_expediente,'') = '' then (case when sum=12 then 'EN GESTIÓN' ELSE 'ASIGNADO' END) else 'EN REVISIÓN' end)
        END) as caso
        from (
        select 
        I.id_expediente,
        (case when coalesce(ESTADO_FOLIO,0) = 0 then 0 else 1 end)+
        (case when coalesce(PRED_ADQ,0) = 0 then 0 else 1 end)+
        (case when coalesce(DOC_NUM,0) = 0 then 0 else 1 end)+
        (case when coalesce(DOC_FECHA,now()) = now() then 0 else 1 end)+
        (case when coalesce(K.NOM_PROP_MI,'') = '' then 0 else 1 end)+
        (case when coalesce(K.TIPO_DOC_PROP,'') = '' then 0 else 1 end)+
        (case when coalesce(K.NUM_DOC_PROP,'') = '' then 0 else 1 end)+
        (case when coalesce(K.PORCENT_COPROP,0) = 0 then 0 else 1 end)+
        (case when coalesce(L.NOM_ANTE_PROP,'') = '' then 0 else 1 end)+
        (case when coalesce(L.TIPO_DOC_PROP,'') = '' then 0 else 1 end)+
        (case when coalesce(L.NUM_DOC_PROP,'') = '' then 0 else 1 end)+
        (case when coalesce(L.PORCENT_COPROP,0) = 0 then 0 else 1 end) AS sum
        from info5_juridicos I
        LEFT JOIN (select * from info21_juridicos where consecutivo=1) J
        on I.id_expediente=J.id_expediente
        LEFT JOIN (select * from info8_propietario_juridico where consecutivo=1) K
        on I.id_expediente=K.id_expediente
        LEFT JOIN (select * from info6_propietario_anterior_juridico where consecutivo=1) L
        on I.id_expediente=L.id_expediente
        )sub1
        LEFT JOIN info13_control_calidad_juridico sub2
        on sub1.id_expediente=sub2.id_expediente
        LEFT JOIN (
        select distinct id_expediente 
        from tareas.tareas
        where estado=1 and ruta=4
        )sub3
        on sub1.id_expediente=sub3.id_expediente

        )sub1
        group by caso)sub	  
        </sql>
    </Consulta>



    <Consulta id="grafico7">
        <sql>
            select array_agg(grupo) as categoria,array_agg(cuenta)as data from(
            select caso as grupo, count(caso)as cuenta from
            (
            select sub1.id_expediente,
            (case when aprobado=1 then 'APROBADO' 
             when aprobado=2 then 
                CASE WHEN COALESCE(sub3.id_expediente, '') != '' THEN 'EN REVISIÓN' ELSE 'DEVUELTO' END
            ELSE  (case when coalesce(sub3.id_expediente,'') = '' then (case when sum=13 then 'EN GESTIÓN' ELSE 'ASIGNADO' END) else 'EN REVISIÓN' end)
            END) as caso
            from (	  
            select
            I.id_expediente,
            (case when coalesce(ID_PROYECTO,'') = '' then 0 else 1 end)+
            (case when coalesce(PORCENTAJE_AREA_EN_DUP,0) = 0 then 0 else 1 end)+  
            (case when coalesce(AREA_EN_DUP,0) = 0 then 0 else 1 end)+	 
            (case when coalesce(NOM_PROY,'') = '' then 0 else 1 end)+
            (case when coalesce(CHIP_CAT,'') = '' then 0 else 1 end)+
            (case when coalesce(NUM_MI,'') = '' then 0 else 1 end)+
            (case when coalesce(DIR_ACT,'') = '' then 0 else 1 end)+
            (case when coalesce(DEST_ECONO,0) = 0 then 0 else 1 end)+
            (case when coalesce(DEST_USO_EAAB,0) = 0 then 0 else 1 end)+
            (case when coalesce(NIVEL_PRIOR,0) = 0 then 0 else 1 end)+
            (case when coalesce(OBS_ESPECIFICAS,'') = '' then 0 else 1 end)+
            (case when coalesce(AVAL,0) = 0 then 0 else 1 end)+
            (case when coalesce(TIP_INFRA,'{}') = '{}' then 0 else 1 end) as sum	  
            from info1_general_proyecto I
            LEFT JOIN info2_general_predio J
            on I.id_expediente=J.id_expediente
            LEFT JOIN info4_avaluos	K
            on I.id_expediente=K.id_expediente	
            LEFT JOIN info10_infraestructura L
            on I.id_expediente=L.id_expediente
            )sub1
            LEFT JOIN info12_control_calidad_tecnico sub2
            on sub1.id_expediente=sub2.id_expediente	
            LEFT JOIN (
            select distinct id_expediente 
            from tareas.tareas
            where estado=1 and ruta=3
            )sub3
            on sub1.id_expediente=sub3.id_expediente		
            )sub1
            group by caso)sub
        </sql>
    </Consulta>




    <Consulta id="get_metadata">
        <sql>
            select * from doc_grupo
        </sql>
    </Consulta>



    <Consulta id="get_permisos">
        <sql>
           select jsonb_agg(id_permiso)as permisos
            from(
            select p.id_permiso
            from usuario u
            inner join rol_permisos r
            on r.id_rol=u.usuario_rol
            inner join permisos p
            on r.id_permiso=p.id_permiso

            where usuario_usuario=token
            union 
            select id_permiso
            from usuario u
            natural join usr_permisos up
            where usuario_usuario=token

            )As s
        </sql>
    </Consulta>


    <Consulta id="get_flujo">
        <sql>
            select 
                t.ruta,
                id_tarea_next,
                path,
                (select usuario_nombre from usuario where usuario_usuario=t.usuario_responsable),
                f.descripcion as descripcion,
                ta.descripcion as perfil,
                estado,
                fecha_asignacion,
                fecha_solucion,
                (select aprobado from info12_control_calidad_tecnico where id_expediente = t.id_expediente) as tec,
				(select aprobado from info13_control_calidad_juridico where id_expediente = t.id_expediente) as jur
            from tareas.tareas t left join (
            select id_tarea_next,concat(id_tarea,'-',id_tarea_next)as path,ruta,descripcion
            from tareas.flujo
            ) f
            on t.ruta=f.ruta 
            inner join tareas.actividades ta on f.id_tarea_next=ta.id_tarea
            where id_expediente=$id_expediente order by fecha_asignacion
        </sql>
    </Consulta>

    <Consulta id="get_flujo_saneamiento">
        <sql>
            select 
                t.ruta,
                id_tarea_next,
                t.consecutivo,
                path,
                (select usuario_nombre from usuario where usuario_usuario=t.usuario_responsable),
                f.descripcion as descripcion,
                ta.descripcion as perfil,
                estado,
                fecha_asignacion,
                fecha_solucion,
                (select aprobado from info12_control_calidad_tecnico where id_expediente = t.id_expediente) as tec,
				(select aprobado from info13_control_calidad_juridico where id_expediente = t.id_expediente) as jur
            from tareas.tareas_saneamientos t left join (
            select id_tarea_next,concat(id_tarea,'-',id_tarea_next)as path,ruta,descripcion
            from tareas.flujo_saneamientos
            ) f
            on t.ruta=f.ruta 
            inner join tareas.actividades ta on f.id_tarea_next=ta.id_tarea
            where id_expediente=$id_expediente
            and tabla = $tabla
            and consecutivo = $consecutivo
            order by fecha_asignacion
        </sql>
    </Consulta>


    <Consulta id="insertar_vacio">
        <sql>
           
           insert into insert-dinamico(id_expediente) values ($id_expediente)
            returning id_expediente;
        </sql>
    </Consulta>

    <Consulta id="insertar_vacio_servidumbres">
        <sql>
           
           insert into insert-dinamico(id_servidumbre) values ($id_servidumbre)
            returning id_servidumbre;
        </sql>
    </Consulta>
    <Consulta id="get_consecutivos">
        <sql>
           
           select consecutivo from insert-dinamico where id_expediente=$id_expediente
        </sql>
    </Consulta>
    <Consulta id="get_consecutivos_servidumbres">
        <sql>
           
           select consecutivo from insert-dinamico where id_servidumbre=$id_servidumbre
        </sql>
    </Consulta>



    <Consulta id="tengo_predio">
        <sql>
        select exists(
           select * from tareas.tareas
            where id_expediente=$id_expediente 
            and usuario_responsable=token and estado=1)
        </sql>
    </Consulta>

    <Consulta id="tengo_predio_saneamiento">
        <sql>
        select exists(
           select * from tareas.tareas_saneamientos
            where id_expediente=$id_expediente 
            and usuario_responsable=token and estado=1)
        </sql>
    </Consulta>

    <Consulta id="get_soportes">
        <sql>
        select * from documentos where identificador=$identificador	  
        </sql>
    </Consulta>

    <Consulta id="insert_consecutivo">
        <sql>

       insert into insert-dinamico(id_expediente,consecutivo)
        values ($id_expediente,coalesce((select max(consecutivo)+1 
		from insert-dinamico where id_expediente=$id_expediente),1)
	  	)returning id_expediente


        </sql>
    </Consulta>

    <Consulta id="insert_prestamo">
        <sql>

       insert into insert-dinamico(id_expediente,consecutivo,usuario_prestamo, fecha_sol_usu_prestamo)
        values ($id_expediente,coalesce((select max(consecutivo)+1 
		from insert-dinamico where id_expediente=$id_expediente),1),token, now()
	  	)returning id_expediente


        </sql>
    </Consulta>

    <Consulta id="insert_consecutivo_servidumbres">
        <sql>

       insert into insert-dinamico(id_servidumbre,consecutivo)
        values ($id_servidumbre,coalesce((select max(consecutivo)+1 
		from insert-dinamico where id_servidumbre=$id_servidumbre),1)
	  	)returning id_servidumbre


        </sql>
    </Consulta>

    <Consulta id="delete_consecutivo">
        <sql>

        delete from insert-dinamico where id_expediente=$id_expediente and consecutivo=$consecutivo returning id_expediente


        </sql>
    </Consulta>

    <Consulta id="info_header_form">
        <sql>
   select ad.calculo_matricula as num_mi, iic.numero_predial_nacional 
    from info2_adquisicion ad
    left join info4_informacion_catastral iic on ad.id_expediente = iic.id_expediente 
        where ad.id_expediente=$id_expediente;
        </sql>
    </Consulta>

    <Consulta id="info_header_form_servidumbre">
        <sql>

        select chip_cat,matricula,cod_predial 
        from servidumbres.info2_general_predio_sirviente
        where id_servidumbre=$id_servidumbre


        </sql>
    </Consulta>

    <Consulta id="get_dominios">
        <sql>
        select distinct dominio
        from dominios
        </sql>
    </Consulta>

    <Consulta id="get_valores_dominios">
        <sql>
        select *
            from dominios
            where dominio = $dominio
            order by valor
        </sql>
    </Consulta>

    <Consulta id="insert_valor_dominios">
        <sql>
        INSERT INTO dominios
            VALUES ($dominio, $valor,$descripcion)
            ON CONFLICT (dominio, valor) DO UPDATE
            SET descripcion = $descripcion
            returning dominio
        </sql>
    </Consulta>

    <Consulta id="reporte_dominios">
        <sql>
        select *
        from dominios
        where dominio = $dominio
        order by valor
        </sql>
    </Consulta>

    <Consulta id="get_tipologias">
        <sql>
        select *
        from doc_grupo
        order by cod_grupo
        </sql>
    </Consulta>

    <Consulta id="insert_valor_tipologia">
        <sql>
        INSERT INTO doc_grupo
            VALUES ($cod_grupo, $nombre, $componente, $formato, $responsable)
            ON CONFLICT (cod_grupo) DO UPDATE
            SET nombre = $nombre, componente = $componente, formato = $formato, responsable = $responsable
            returning doc_grupo
        </sql>
    </Consulta>

    <Consulta id="reporte_tipologias">
        <sql>
        select *
        from doc_grupo
        order by cod_grupo
        </sql>
    </Consulta>

    <Consulta id="insert_valor_usuario">
        <sql>
        INSERT INTO usuario
            VALUES ((select max (usuario_id)+1 from usuario),$usuario_usuario, md5('123456'),$usuario_rol, $usuario_nombre, $usuario_correo, $usuario_cargo, true, 
            null,$usuario_contrato,null)
            ON CONFLICT (usuario_usuario) DO UPDATE
            SET usuario_rol = $usuario_rol, usuario_nombre = $usuario_nombre, usuario_correo = $usuario_correo,
            usuario_cargo = $usuario_cargo, usuario_contrato = $usuario_contrato
            returning usuario_id
        </sql>
    </Consulta>

    <Consulta id="insert_rol_admin">
        <sql>
        INSERT INTO usr_permisos
            VALUES ($id_usuario,10)
            ON CONFLICT (usuario_id,id_permiso) DO UPDATE
            SET id_permiso = 10
            returning usuario_id
        </sql>
    </Consulta>

    <Consulta id="insert_calidad_tecnico">
        <sql>
        INSERT INTO info8_control_calidad_catastral
            VALUES ($id_expediente,$aprobado, $obs)
            ON CONFLICT (id_expediente) DO UPDATE
            SET aprobado = $aprobado, observacion = $obs
            returning id_expediente
        </sql>
    </Consulta>

    <Consulta id="insert_calidad_juridico">
        <sql>
        INSERT INTO info13_control_calidad_juridico
            VALUES ($id_expediente,$aprobado, null,$obs, null, now())
            ON CONFLICT (id_expediente) DO UPDATE
            SET aprobado = $aprobado, obs = $obs, fecha_aprob = now()
            returning id_expediente
        </sql>
    </Consulta>

    <Consulta id="update_tareas_calidad_tecnico">
        <sql>
        UPDATE tareas.tareas
            SET estado = 2,fecha_solucion = now()
            WHERE id_expediente = $id_expediente and ruta = 3 and estado = 1
            returning id_expediente
        </sql>
    </Consulta>

    <Consulta id="update_tareas_calidad_juridico">
        <sql>
        UPDATE tareas.tareas
            SET estado = 2,fecha_solucion = now()
            WHERE id_expediente = $id_expediente and ruta = 4 and estado = 1
            returning id_expediente
        </sql>
    </Consulta>

    <Consulta id="borrar_tarea">
        <sql>
        DELETE from tareas.tareas
        WHERE id_expediente = $id_expediente and ruta = ANY($ruta_close::int[])
        returning id_expediente
        </sql>
    </Consulta>

    <Consulta id="cerrar_tarea">
        <sql>
        UPDATE tareas.tareas
            SET estado = 2,fecha_solucion = now()
            WHERE id_expediente = $id_expediente and ruta = ANY($ruta_close::int[]) and estado = 1
            returning id_expediente
        </sql>
    </Consulta>

    <Consulta id="abrir_tarea">
        <sql>
        UPDATE tareas.tareas
            SET estado = 1,fecha_solucion = null
            WHERE id_expediente = $id_expediente and ruta = ANY($ruta_close::int[]) and estado = 2
            returning id_expediente
        </sql>
    </Consulta>

    <Consulta id="get_observacion">
        <sql>
            select d.descripcion, d.bloqueo_predio
            from info23_sig igp
            left join dominios d on igp.observacion_sig::text = d.valor
            and d.dominio = 'Observ_SIG'
            where igp.id_expediente=$id_expediente
        </sql>
    </Consulta>

    <Consulta id="eval_validadores">
        <sql>
            select *
            from eval_validadores($formulario, $expediente);
        </sql>
    </Consulta>

    <Consulta id="get_validadores">
        <sql>
            select *
            from resultados_validacion rv
            join validadores v on rv.id_validador = v.id_validador
            where rv.id_expediente = $expediente
            and rv.estado = false
            and v.id_formulario = $formulario
            order by estado, id_condicion ;
        </sql>
    </Consulta>

    <Consulta id="get_dup">
        <sql>
            select *
            from dup
            where id_proyecto = $proyecto;
        </sql>
    </Consulta>

    <Consulta id="get_dups_lista">
        <sql>
            select *
            from dup;
        </sql>
    </Consulta>

     <Consulta id="insert_valor_dup">
        <sql>
        INSERT INTO dup
            VALUES ((select max (id_dup)+1 from dup),$id_proyecto, $cod_dup,$fecha_actadm, $objet_res, $nom_proy, $actadm_anteriores, $observacion)
            ON CONFLICT (id_proyecto) DO UPDATE
            SET id_proyecto = $id_proyecto, cod_dup = $cod_dup, fecha_actadm = $fecha_actadm, objet_res = $objet_res, nom_proy = $nom_proy,
            actadm_anteriores = $actadm_anteriores, observacion = $observacion
            returning id_dup
        </sql>
    </Consulta>

    <Consulta id="get_servicios">
        <sql>
            select *
            from servicios s
            where s.id_formulario = $id_formulario;
        </sql>
    </Consulta>

    <Consulta id="insert_valor_validacion">
        <sql>
            INSERT INTO resultados_validacion
            VALUES ($id_validador,$id_condicion,$estado,$id_expediente)
            ON CONFLICT (id_validador,id_condicion,id_expediente) DO UPDATE
            SET estado = $estado
            returning id_validador,id_condicion,id_expediente
        </sql>
    </Consulta>

    <Consulta id="validacion_masiva">
        <sql>
            select eval_validadores(va.id_formulario::integer,pr.id_expediente)
                from info2_general_predio pr, 
                (select distinct id_formulario from validadores) va
                order by pr.id_expediente, va.id_formulario;
        </sql>
    </Consulta>

    <Consulta id="reporte_validacion">
        <sql>
            select *
                from resultados_validacion;
        </sql>
    </Consulta>

    <Consulta id="get_asignaciones">
        <sql>
            select id_expediente, 
			(select usuario_nombre from usuario where usuario_usuario=asg.usuario),
			ac.id_tarea,
			ac.descripcion
			from tareas.asignacion asg join 
			tareas.actividades ac on asg.id_tarea = ac.id_tarea
			where id_expediente = $id_expediente;
        </sql>
    </Consulta>

    <Consulta id="get_asignaciones_saneamientos">
        <sql>
            select id_expediente, 
			(select usuario_nombre from usuario where usuario_usuario=asg.usuario),
			ac.id_tarea,
			ac.descripcion
			from tareas.asignacion_saneamientos asg join 
			tareas.actividades ac on asg.id_tarea = ac.id_tarea
			where id_expediente = $id_expediente;
        </sql>
    </Consulta>

    <Consulta id="update_predio">
        <sql>
        UPDATE geometria.lote_asignacion
            SET estado = $estado
            WHERE id=$id and id_expediente = $id_expediente
            returning id_expediente
        </sql>
    </Consulta>

    <Consulta id="update_servidumbre">
        <sql>
        UPDATE geometria.servidumbre
            SET estado = $estado
            WHERE id=$id and id_expedie = $id_expediente
            returning id_expedie
        </sql>
    </Consulta>

    <Consulta id="get_estado_prestamo">
        <sql>
        select count(*)
        from info37_prestamo_expedientes
        where id_expediente = $id_expediente 
        and fecha_dev_usu_prestamo is null
        and fecha_ent_usu_prestamo is not null;
        </sql>
    </Consulta>

    <Consulta id="check_prestamo">
        <sql>
        select exists (
            select *
            from tareas.tareas
            where id_expediente = $id_expediente
            and ruta = $ruta_destino
            and usuario_asigna = $usuario
            and estado = 1
            and usuario_responsable = (select usuario from tareas.asignacion 
            where id_expediente=$id_expediente and id_tarea= $tarea_next));
        </sql>
    </Consulta>

    <Consulta id="get_parametros_busqueda">
        <sql>
            select *    
            from busqueda_avanzada_filtros
            order by id;
        </sql>
    </Consulta>

    <Consulta id="update_parametros_busqueda">
        <sql>
            select *
            from busqueda_avanzada_resultado
            where where_parametros_avanzados;
        </sql>
    </Consulta>

    <Consulta id="get_reporte_tecnico">
        <sql>
            select *
            from reporte_tecnico
            where id_expediente=$id_expediente;
        </sql>
    </Consulta>

    <Consulta id="get_reporte_juridico">
        <sql>
            select *
            from reporte_juridico
            where id_expediente=$id_expediente;
        </sql>
    </Consulta>

    <Consulta id="get_reporte_propietarios">
        <sql>
            select *
            from reporte_juridico_propietarios
            where id_expediente=$id_expediente;
        </sql>
    </Consulta>

    <Consulta id="get_reporte_segregados">
        <sql>
            select *
            from reporte_juridico_segregados
            where id_expediente=$id_expediente;
        </sql>
    </Consulta>

    <Consulta id="get_descripcion_saneamientos">
        <sql>
            select *
            from actividades_saneamiento
            where cod_accion_saneamiento = $accion_saneamiento
            and dominio = $dominio;
        </sql>
    </Consulta>

    <Consulta id="insertar_notificacion_saneamiento">
        <sql>
        insert into tareas.tareas_saneamientos values(
            (select max (id)+1 from tareas.tareas_saneamientos),
            $id_expediente,
            $ruta_destino,
            token,
            (select usuario from tareas.asignacion_saneamientos
            where id_expediente=$id_expediente and id_tarea= $tarea_next),
            now(),
            null,
            1,
            true,
            $consecutivo,
            $tabla
        )ON CONFLICT DO NOTHING RETURNING usuario_responsable
        </sql>
    </Consulta>

    <Consulta id="get_ultimo_expediente">
        <sql>
        select max(id_expediente)::int + 1 as expediente
            from info2_adquisicion ia ;
        </sql>
    </Consulta>

    <Consulta id="insert_expediente_2">
        <sql>
        insert into info2_adquisicion (id_expediente) values ($id_expediente);
        </sql>
    </Consulta>

    <Consulta id="insert_expediente_1">
        <sql>
        insert into info4_informacion_catastral (id_expediente) values ($id_expediente);
        </sql>
    </Consulta>

    <Consulta id="insert_expediente_4">
        <sql>
        insert into info1_fuente (id_expediente) values ($id_expediente);
        </sql>
    </Consulta>
     <Consulta id="insert_expediente_5">
        <sql>
        insert into info7_control_calidad_juridico (id_expediente) values ($id_expediente);
        </sql>
    </Consulta>
     <Consulta id="insert_expediente_6">
        <sql>
        insert into info8_control_calidad_catastral (id_expediente) values ($id_expediente);
        </sql>
    </Consulta>
    <Consulta id="insert_expediente_7">
        <sql>
        insert into info5_informacion_invias (id_expediente) values ($id_expediente);
        </sql>
    </Consulta>

    <Consulta id="insert_info5_juridicos">
        <sql>
        insert into info5_juridicos (id_expediente) values ($id_expediente);
        </sql>
    </Consulta>

    <Consulta id="get_reporte_san">
        <sql>
            select *
            from reporte_saneamientos
        </sql>
    </Consulta>

    <Consulta id="get_comunicados">
        <sql>
            select *
            from comunicados
            where id_expediente = $id_expediente
            and consecutivo_saneamiento = $consecutivo
            and tabla = $tabla
            and saneamiento = $saneamiento
        </sql>
    </Consulta>

    <Consulta id="insertar_comunicado">
        <sql>
           INSERT INTO comunicados
            VALUES ($id_expediente, $consecutivo_saneamiento,(select coalesce(max(consecutivo_comunicado) + 1,1)
                from comunicados where id_expediente = $id_expediente and consecutivo_saneamiento = $consecutivo_saneamiento),
                $fecha_comunicado, $radicado_invias_comunicado, $objeto_comunicado, $entidad_comunicado, $tabla, $entregable, $enlace, $observacion, $tipo_respuesta, $saneamiento);
        </sql>
    </Consulta>

    <Consulta id="get_comunicado">
        <sql>
            select *
            from comunicados
            where id_expediente = $id_expediente
            and consecutivo_saneamiento = $consecutivo
            and consecutivo_comunicado = $consecutivo_com
            and tabla = $tabla
        </sql>
    </Consulta>

    <Consulta id="delete_comunicado">
        <sql>
            delete from comunicados
            where id_expediente = $id_expediente
            and consecutivo_saneamiento = $consecutivo_saneamiento
            and consecutivo_comunicado = $consecutivo_comunicado
            and tabla = $tabla
        </sql>
    </Consulta>

    <Consulta id="editar_comunicado">
        <sql>
            update comunicados
            set fecha_comunicado = $fecha_comunicado, radicado_invias_comunicado = $radicado_invias_comunicado, 
            objeto_comunicado = $objeto_comunicado, entidad_comunicado = $entidad_comunicado, entregable = $entregable, 
            enlace = $enlace, observacion = $observacion, tipo_respuesta = $tipo_respuesta
            where id_expediente = $id_expediente
            and consecutivo_saneamiento = $consecutivo_saneamiento
            and consecutivo_comunicado = $consecutivo_comunicado
            and tabla = $tabla
        </sql>
    </Consulta>

    <Consulta id="get_estado_san_tecnicos">
        <sql>
        select *
        from estado_saneamientos_tecnicos
        where id_expediente = $id_expediente
        and consecutivo = $consecutivo
        </sql>
    </Consulta>

    <Consulta id="get_estado_san_juridicos">
        <sql>
        select *
        from estado_saneamientos_juridicos
        where id_expediente = $id_expediente
        and consecutivo = $consecutivo
        </sql>
    </Consulta>

    <Consulta id="get_tarea_activa">
        <sql>
        select t.*,u.usuario_nombre usuario
        from tareas.tareas t 
        left join usuario u on t.usuario_responsable = u.usuario_usuario 
        where id_expediente = $id_expediente
        and estado = 1 and fecha_solucion is null
        limit 1;
        </sql>
    </Consulta>

    <Consulta id="get_enum">
        <sql>
            distinct_busqueda_saneamientos
        </sql>
    </Consulta>

    <Consulta id="validacion_expediente">
        <sql>
            select eval_validadores(va.id_formulario::integer,ia.id_expediente)
               from info2_adquisicion ia,
               (select distinct id_formulario from validadores) va
               where ia.id_expediente = $id_expediente;
        </sql>
    </Consulta>

    <Consulta id="get_validadores_expediente">
        <sql>
            select *, v.campo 
                from resultados_validacion rv 
                join validadores v on rv.id_validador = v.id_validador
                where rv.id_expediente = $id_expediente and estado = false
                order by estado, rv.id_validador,rv.id_condicion;
        </sql>
    </Consulta>
    <Consulta id="grafico_titularidad">
        <sql>
            select array_agg(grupo) as categoria,array_agg(cuenta) as data from(
            select d.descripcion as grupo, count(titular) as cuenta
            from info2_adquisicion ia
            left join dominios d on ia.titular::text = d.valor and d.dominio = 'DOM_TRANSFERENCIA'
            where titular is not null
            group by d.descripcion) sub
        </sql>
    </Consulta>
    <Consulta id="grafico_departamento">
        <sql>
            select array_agg(grupo) as categoria,array_agg(cuenta) as data from(
            select d.descripcion as grupo, count(departamento) as cuenta
            from info4_informacion_catastral ia
            left join dominios d on ia.departamento::text = d.valor and d.dominio = 'DOM_DEPTO'
            where departamento is not null
            group by d.descripcion
            limit 10) sub;
        </sql>
    </Consulta>
    <Consulta id="grafico_administrador">
        <sql>
             select array_agg(grupo) as categoria,array_agg(cuenta) as data from(
            select d.descripcion as grupo, count(administrador) as cuenta
            from info5_informacion_invias ia
            left join dominios d on ia.administrador::text = d.valor and d.dominio = 'DOM_ADMIN'
            where administrador is not null
            group by d.descripcion) sub;
        </sql>
    </Consulta>
    <Consulta id="grafico_publico">
        <sql>
              select array_agg(grupo) as categoria,array_agg(cuenta) as data from(
            select d.descripcion as grupo, count(tipo_bien) as cuenta
            from info5_informacion_invias ia
            left join dominios d on ia.tipo_bien::text = d.valor and d.dominio = 'DOM_TIPO_BIEN'
            where tipo_bien is not null
            group by d.descripcion) sub;
        </sql>
    </Consulta>
    <Consulta id="grafico_transporte">
        <sql>
            select array_agg(grupo) as categoria,array_agg(cuenta) as data from(
           select d.descripcion as grupo , count(modo_trans) as cuenta
           from (select unnest(modo_trans) modo_trans 
           from info5_informacion_invias
           where modo_trans is not null) a
           left join dominios d on a.modo_trans::text = d.valor and d.dominio = 'DOM_MODO_TRANS'
           group by d.descripcion) sub;
        </sql>
    </Consulta>
    <Consulta id="estadistica_contable">
        <sql>
        select count(*) as estadistica 
        from info43_contabilidad
        where clasificacion_contable = 9;
        </sql>
    </Consulta>
    <Consulta id="aprobar_tecnico">
        <sql>
        update info12_control_calidad_tecnico
        set aprobado = $aprobado
        where id_expediente = $id_expediente;
        </sql>
    </Consulta>
    <Consulta id="get_entregables_saneamiento">
        <sql>
        select *
        from entregable_saneamiento
        where id_saneamiento = $id_saneamiento;
        </sql>
    </Consulta>
    <Consulta id="get_campos_entregable">
        <sql>
        select ms.*
        from entregables_campos ec 
        join modulos_saneamientos ms on ec.id_campo = ms.id_campo 
        where id_entregable = $id_entregable;
        </sql>
    </Consulta>
    <Consulta id="get_estado_contabilidad">
        <sql>
        select ic.id_expediente, d.descripcion 
        from info43_contabilidad ic 
        left join dominios d on ic.clasificacion_contable::text = d.valor and d.dominio = 'DOM_CLAS_CONTABLE'
        where ic.id_expediente = $id_expediente;
        </sql>
    </Consulta>
    <Consulta id="get_estado_documental">
        <sql>
        select iae.id_expediente, d.descripcion 
        from info11_adquisicion_escritura iae 
        left join dominios d on iae.estado_busqueda::text = d.valor and d.dominio = 'DOM_ESTADO_BUSQUEDA'
        where iae.id_expediente = $id_expediente;
        </sql>
    </Consulta>
    <Consulta id="get_estado_san_juridico">
        <sql>
        select *
        from estado_san_juridicos
        where id_expediente = $id_expediente
        order by id_expediente;
        </sql>
    </Consulta>

</Consultas>